<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0A1929">
    <meta name="description" content="Zanobot - AI Assistant für akustische Maschinenüberwachung">

    <title>Zanobot - AI Assistant</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
    <link rel="apple-touch-icon" href="icons/icon-512.png">

    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">

    <!-- Theme Bootstrap (loads before render) -->
    <script src="js/theme-bootstrap.js"></script>
</head>
<body>
    <!-- Microphone Status Badge -->
    <div id="mic-status-badge" class="status-badge" style="display: none;">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
            <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
            <line x1="12" y1="19" x2="12" y2="23"></line>
            <line x1="8" y1="23" x2="16" y2="23"></line>
        </svg>
        <span id="mic-status-text">Mikrofon bereit</span>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo-section">
                <div class="logo">
                    <svg width="48" height="48" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <!-- Brain/Head Icon with Sound Waves -->
                        <circle cx="50" cy="45" r="30" stroke="var(--primary-color)" stroke-width="2.5" fill="none"/>
                        <!-- Brain connections -->
                        <circle cx="45" cy="35" r="3" fill="var(--primary-color)"/>
                        <circle cx="55" cy="35" r="3" fill="var(--primary-color)"/>
                        <circle cx="50" cy="45" r="3" fill="var(--primary-color)"/>
                        <circle cx="45" cy="52" r="3" fill="var(--primary-color)"/>
                        <circle cx="55" cy="52" r="3" fill="var(--primary-color)"/>
                        <line x1="45" y1="35" x2="50" y2="45" stroke="var(--primary-color)" stroke-width="1.5"/>
                        <line x1="55" y1="35" x2="50" y2="45" stroke="var(--primary-color)" stroke-width="1.5"/>
                        <line x1="50" y1="45" x2="45" y2="52" stroke="var(--primary-color)" stroke-width="1.5"/>
                        <line x1="50" y1="45" x2="55" y2="52" stroke="var(--primary-color)" stroke-width="1.5"/>
                        <!-- Sound waves -->
                        <path d="M 15 30 Q 12 35 15 40" stroke="var(--primary-color)" stroke-width="2" fill="none"/>
                        <path d="M 10 25 Q 5 35 10 45" stroke="var(--primary-color)" stroke-width="2" fill="none"/>
                        <path d="M 20 35 L 18 38 L 20 41" stroke="var(--primary-color)" stroke-width="2" fill="none"/>
                        <circle cx="25" cy="38" r="1.5" fill="var(--primary-color)"/>
                    </svg>
                </div>
                <div class="branding">
                    <h1 class="brand-title">ZANOBO</h1>
                    <p class="brand-subtitle">AI ASSISTANT</p>
                </div>
            </div>

            <!-- Theme Switcher -->
            <div class="theme-switcher">
                <button class="theme-btn" data-theme="dark" title="Dunkler Modus">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                    </svg>
                </button>
                <button class="theme-btn" data-theme="light" title="Heller Modus">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"/>
                        <line x1="12" y1="1" x2="12" y2="3"/>
                        <line x1="12" y1="21" x2="12" y2="23"/>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                        <line x1="1" y1="12" x2="3" y2="12"/>
                        <line x1="21" y1="12" x2="23" y2="12"/>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                    </svg>
                </button>
                <button class="theme-btn active" data-theme="brand" title="Zanobot Design">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                        <path d="M2 17l10 5 10-5"/>
                        <path d="M2 12l10 5 10-5"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Container 1: Welcome Section (nicht einklappbar) -->
        <section class="main-container">
            <div class="container-content">
                <h2 class="welcome-title">Willkommen, <span id="user-name">Zanobo 123</span></h2>
                <p class="welcome-subtitle">Maschinenüberwachung</p>
            </div>
        </section>

        <!-- Container 2: Hauptaktionen (mit einklappbaren Unter-Containern) -->
        <section class="main-container">
            <div class="container-content">
                <!-- Scan Machine -->
                <div class="sub-container collapsible">
                    <div class="sub-header section-header" data-target="scan-machine-content">
                        <div class="sub-header-content">
                            <div class="sub-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--primary-color)" stroke-width="1.5">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                    <rect x="7" y="7" width="3" height="3"/>
                                    <rect x="14" y="7" width="3" height="3"/>
                                    <rect x="7" y="14" width="3" height="3"/>
                                    <rect x="14" y="14" width="3" height="3"/>
                                    <path d="M3 9h18M9 3v18M15 3v18M3 15h18"/>
                                </svg>
                            </div>
                            <h4 class="sub-title">Maschine scannen</h4>
                        </div>
                        <svg class="collapse-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"/>
                        </svg>
                    </div>
                    <div id="scan-machine-content" class="collapsible-content" style="display: none;">
                        <div class="sub-content">
                            <p class="sub-description">Identifiziere Maschine via QR-Code</p>
                            <button class="action-btn" id="scan-btn">Scannen</button>
                        </div>
                    </div>
                </div>

                <!-- Record Reference -->
                <div class="sub-container collapsible">
                    <div class="sub-header section-header" data-target="record-reference-content">
                        <div class="sub-header-content">
                            <div class="sub-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--primary-color)" stroke-width="1.5">
                                    <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                                    <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                                    <line x1="12" y1="19" x2="12" y2="23"/>
                                    <line x1="8" y1="23" x2="16" y2="23"/>
                                </svg>
                            </div>
                            <h4 class="sub-title">Referenz aufnehmen</h4>
                        </div>
                        <svg class="collapse-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"/>
                        </svg>
                    </div>
                    <div id="record-reference-content" class="collapsible-content" style="display: none;">
                        <div class="sub-content">
                            <p class="sub-description">10-Sekunden Referenzaufnahme</p>
                            <button class="action-btn" id="record-btn">Aufnehmen</button>
                        </div>
                    </div>
                </div>

                <!-- Run Diagnosis -->
                <div class="sub-container collapsible">
                    <div class="sub-header section-header" data-target="run-diagnosis-content">
                        <div class="sub-header-content">
                            <div class="sub-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--primary-color)" stroke-width="1.5">
                                    <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/>
                                    <polyline points="17 6 23 6 23 12"/>
                                </svg>
                            </div>
                            <h4 class="sub-title">Diagnose starten</h4>
                        </div>
                        <svg class="collapse-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"/>
                        </svg>
                    </div>
                    <div id="run-diagnosis-content" class="collapsible-content" style="display: none;">
                        <div class="sub-content">
                            <p class="sub-description">Live-Analyse durchführen</p>
                            <button class="action-btn" id="diagnose-btn">Analysieren</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Container 3: Maschinenübersicht -->
        <section class="main-container collapsible">
            <div class="main-header section-header" data-target="machine-overview">
                <h3 class="container-title">Maschinenübersicht</h3>
                <svg class="collapse-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"/>
                </svg>
            </div>
            <div id="machine-overview" class="collapsible-content" style="display: none;">
                <div class="container-content">
                    <div class="machine-list">
                        <!-- Example Machine Items -->
                        <div class="machine-item">
                            <div class="machine-info">
                                <h4 class="machine-name">Zanobo 123</h4>
                                <p class="machine-status status-healthy">Healthy</p>
                                <p class="machine-time">Letzte Prüfung vor 3min</p>
                            </div>
                            <svg class="chevron-right" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="9 18 15 12 9 6"/>
                            </svg>
                        </div>
                        <div class="machine-item">
                            <div class="machine-info">
                                <h4 class="machine-name">Zanobo 9</h4>
                                <p class="machine-status status-uncertain">Uncertain</p>
                                <p class="machine-time">Letzte Prüfung vor 12min</p>
                            </div>
                            <svg class="chevron-right" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="9 18 15 12 9 6"/>
                            </svg>
                        </div>
                        <button class="add-reference-btn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                            Neue Referenz
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Container 4: Quick Check -->
        <section class="main-container">
            <div class="container-content">
                <button class="quick-check-btn">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                        <path d="M2 17l10 5 10-5"/>
                    </svg>
                    Quick Check
                </button>
            </div>
        </section>

        <!-- Container 5: Historie -->
        <section class="main-container collapsible">
            <div class="main-header section-header" data-target="history">
                <h3 class="container-title">Historie</h3>
                <svg class="collapse-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"/>
                </svg>
            </div>
            <div id="history" class="collapsible-content" style="display: none;">
                <div class="container-content">
                    <div class="history-list">
                        <p class="empty-state">Noch keine Messungen vorhanden</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Container 6: Einstellungen -->
        <section class="main-container collapsible">
            <div class="main-header section-header" data-target="settings">
                <h3 class="container-title">Einstellungen</h3>
                <svg class="collapse-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"/>
                </svg>
            </div>
            <div id="settings" class="collapsible-content" style="display: none;">
                <div class="container-content">
                    <div class="settings-list">
                        <div class="setting-item">
                            <label for="confidence-threshold">Vertrauensschwelle</label>
                            <input type="range" id="confidence-threshold" min="0" max="100" value="75">
                            <span id="confidence-value">75%</span>
                        </div>
                        <div class="setting-item">
                            <label for="recording-duration">Aufnahmedauer</label>
                            <select id="recording-duration">
                                <option value="5">5 Sekunden</option>
                                <option value="10" selected>10 Sekunden</option>
                                <option value="15">15 Sekunden</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer / Legal Info -->
        <footer class="footer">
            <div class="legal-info">
                <button class="footer-link" id="impressum-btn">Impressum</button>
                <span class="separator">•</span>
                <button class="footer-link" id="datenschutz-btn">Datenschutz</button>
                <span class="separator">•</span>
                <button class="footer-link" id="about-btn">Über Zanobot</button>
            </div>
            <p class="copyright">© 2025 Zanobot AI Assistant</p>
        </footer>
    </div>

    <!-- Modal for Recording -->
    <div id="recording-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Referenz aufnehmen</h3>
                <p class="modal-subtitle" id="machine-id">MACHINE 002</p>
            </div>
            <div class="modal-body">
                <canvas id="waveform-canvas" width="300" height="150"></canvas>
                <p class="recording-status" id="recording-status">High audio quality detected</p>
                <p class="recording-timer" id="recording-timer">00:00</p>
                <div class="fingerprint-quality">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4"/>
                    </svg>
                    <span>Fingerprint Quality: <strong id="fingerprint-quality">CONFIDENT</strong></span>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn btn-secondary" id="stop-recording-btn">Stop Recording</button>
                <button class="modal-btn btn-primary" id="save-reference-btn" style="display: none;">Save Reference</button>
            </div>
        </div>
    </div>

    <!-- Modal for Diagnosis Results -->
    <div id="diagnosis-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Diagnoseergebnisse</h3>
                <button class="close-modal-btn" id="close-diagnosis-modal">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="result-card">
                    <div class="result-barcode">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                            <rect x="3" y="6" width="2" height="12"/>
                            <rect x="6" y="6" width="1" height="12"/>
                            <rect x="8" y="6" width="2" height="12"/>
                            <rect x="11" y="6" width="1" height="12"/>
                            <rect x="13" y="6" width="3" height="12"/>
                            <rect x="17" y="6" width="1" height="12"/>
                            <rect x="19" y="6" width="2" height="12"/>
                        </svg>
                        <span id="machine-barcode">1GB4-636A0-Ba1</span>
                    </div>
                    <div class="result-fingerprint">
                        <h4>Fingerprint</h4>
                        <p class="result-status status-healthy" id="result-status">HEALTHY</p>
                        <p class="result-confidence"><span id="result-confidence">87</span>% Confidence score</p>
                    </div>
                    <div class="result-analysis">
                        <h4>Variance</h4>
                        <p class="analysis-label">Frequency anomaly</p>
                        <canvas id="analysis-canvas" width="300" height="100"></canvas>
                        <p class="analysis-hint" id="analysis-hint">Hint: Slightly increased signal around 20 kHz</p>
                    </div>
                    <div class="result-quality">
                        <h4>Reference Quality</h4>
                        <p class="quality-status status-good">GOOD</p>
                        <p class="quality-description">Reference recording meets recommended conditions</p>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn btn-secondary" id="view-history-btn">View History</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/app.js" type="module"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => console.log('SW registered:', registration))
                    .catch(error => console.log('SW registration failed:', error));
            });
        }
    </script>
</body>
</html>
